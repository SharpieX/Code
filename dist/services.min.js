angular.module("stack.service",[]),angular.module("stack.service").factory("Account",["$http",function(a){return{getProfile:function(){return a.get("/api/me")},updateProfile:function(b){return a.put("/api/me",b)}}}]),angular.module("stack.service").factory("userService",["$q","$http","$stamplay","$rootScope","Account",function(a,b,c,d,e){var f=!1;return{isLogged:function(){return f},getUserModel:function(){var b=a.defer();return e.getProfile().then(function(a){a.data.hasOwnProperty("_id")?(f=!0,b.resolve(a.data)):(f=!1,b.resolve(!1))})["catch"](function(a){b.reject(a)}),b.promise}}}]).factory("usersService",["$q","$stamplay","$http",function(a,b,c){return{getUsers:function(){return c({method:"GET",url:"/api/getUsers"})},getById:function(c){var d=a.defer();return b.User.get({_id:c}).then(function(a){d.resolve(a.data[0])})["catch"](function(a){d.reject(a)}),d.promise},searchUser:function(c){var d=a.defer();return b.User.get(c).then(function(a){d.resolve(a.data)})["catch"](function(a){d.reject(a)}),d.promise}}}]),angular.module("stack.service").factory("tagsService",["$http",function(a){return{getTags:function(b){return a({method:"GET",url:"/api/getTags"})},getById:function(a){},searchTag:function(b){return a({method:"POST",url:"/api/searchTags",data:b})}}}]),angular.module("stack.service").factory("questionsService",["$q","userService","tagsService","answersService","$http",function(a,b,c,d,e){function f(a){return a.users_upvote.length-a.users_downvote.length}return{getQuestions:function(a){return e({method:"GET",url:"/api/getQuestions"})},searchQuestion:function(b){var c=a.defer();return e({method:"GET",url:"/api/searchQuestion/id",params:{id:b}}).then(function(a){var b=a.data.data;c.resolve(b)})["catch"](function(a){c.reject(a)}),c.promise},getById:function(b){var c=a.defer();return this.searchQuestion(b).then(function(a){c.resolve(a)}),c.promise},updateViews:function(a){var b=a.views||0;b++},updateModel:function(a,b){var c={};return b.forEach(function(b){for(var d=[],e=0;e<a[b].length;e+=1)d.push(a[b][e]._id);c[b]=d}),c._id=a._id,e({method:"POST",url:"/api/updateQuestion",data:c})},voteUp:function(b,c){var d=a.defer(),e=b,g=e.users_upvote?e.users_upvote:[];return g.push(c._id),e.users_upvote=g,this.updateModel(e,["users_upvote"]).then(function(){d.resolve(f(e))})["catch"](function(a){d.reject(a)}),d.promise},voteDown:function(b){var c=a.defer();return c.promise},commentQuestion:function(a,b){var c=a.comments;return c.push(b.data.data),a.comments=c,this.updateModel(a,["comments"])},saveQuestion:function(a){return e({method:"POST",url:"/api/saveQuestion",data:a})},submitAnswer:function(a,b){var c=a.answers;return c.push(b.data.answer),a.answers=_(c).chain().sortBy(function(a){return a.author.role}).sortBy(function(a){return!a.checked}).value(),this.updateModel(a,["answers"])}}}]),angular.module("stack.service").factory("answersService",["$q","userService","$http","CONSTANTS",function(a,b,c,d){return{createAnswer:function(a,b){return a.author=b._id,a.checked=b.role===d.USER_PERMS.ADMIN.key,c({method:"POST",url:"/api/saveAnswer",data:a})},updateModel:function(a,b){var d={};return Array.isArray(b)?b.forEach(function(b){for(var c=[],e=0;e<a[b].length;e+=1)c.push(a[b][e]._id);d[b]=c}):d[b]=a[b],d._id=a._id,c({method:"POST",url:"/api/updateAnswer",data:d})},voteUp:function(b){var c=a.defer();return c.promise},voteDown:function(b){var c=a.defer();return c.promise},comment:function(a,b){var c=a.comments?a.comments:[];return c.push(b.data.data),a.comments=c,this.updateModel(a,["comments"])},getById:function(a){c({method:"GET",url:"/api/getAnswer/id",params:{id:a}})}}}]),angular.module("stack.service").factory("commentsService",["$q","userService","$http",function(a,b,c){return{createComment:function(a,b,d){var e=d._id,f={text:b,author:e};return c({method:"POST",url:"/api/saveComment",data:f})}}}]),angular.module("stack.service").factory("CONSTANTS",function(){var a={USER_PERMS:{ADMIN:{key:"admin"},USER:{key:"user"}}};return a}),angular.module("stack.service").factory("notificationService",["$q","userService","$http",function(a,b,c){return{notify:function(a,b){var d=location.href,e='<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">\n<html xmlns="http://www.w3.org/1999/xhtml" style="font-family: \'Helvetica Neue\', Helvetica, Arial, sans-serif; box-sizing: border-box; font-size: 14px; margin: 0;">\n<head>\n<meta name="viewport" content="width=device-width" />\n<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />\n<title>Actionable emails e.g. reset password</title>\n\n\n<style type="text/css">\nimg {\nmax-width: 100%;\n}\nbody {\n-webkit-font-smoothing: antialiased; -webkit-text-size-adjust: none; width: 100% !important; height: 100%; line-height: 1.6em;\n}\nbody {\nbackground-color: #f6f6f6;\n}\n@media only screen and (max-width: 640px) {\n	body {\n		padding: 0 !important;\n	}\n	h1 {\n		font-weight: 800 !important; margin: 20px 0 5px !important;\n	}\n	h2 {\n		font-weight: 800 !important; margin: 20px 0 5px !important;\n	}\n	h3 {\n		font-weight: 800 !important; margin: 20px 0 5px !important;\n	}\n	h4 {\n		font-weight: 800 !important; margin: 20px 0 5px !important;\n	}\n	h1 {\n		font-size: 22px !important;\n	}\n	h2 {\n		font-size: 18px !important;\n	}\n	h3 {\n		font-size: 16px !important;\n	}\n	.container {\n		padding: 0 !important; width: 100% !important;\n	}\n	.content {\n		padding: 0 !important;\n	}\n	.content-wrap {\n		padding: 10px !important;\n	}\n	.invoice {\n		width: 100% !important;\n	}\n}\n</style>\n</head>\n\n<body itemscope itemtype="http://schema.org/EmailMessage" style="font-family: \'Helvetica Neue\',Helvetica,Arial,sans-serif; box-sizing: border-box; font-size: 14px; -webkit-font-smoothing: antialiased; -webkit-text-size-adjust: none; width: 100% !important; height: 100%; line-height: 1.6em; background-color: #f6f6f6; margin: 0;" bgcolor="#f6f6f6">\n\n<table class="body-wrap" style="font-family: \'Helvetica Neue\',Helvetica,Arial,sans-serif; box-sizing: border-box; font-size: 14px; width: 100%; background-color: #f6f6f6; margin: 0;" bgcolor="#f6f6f6">\n	<tr style="font-family: \'Helvetica Neue\',Helvetica,Arial,sans-serif; box-sizing: border-box; font-size: 14px; margin: 0;">\n		<td style="font-family: \'Helvetica Neue\',Helvetica,Arial,sans-serif; box-sizing: border-box; font-size: 14px; vertical-align: top; margin: 0;" valign="top"></td>\n				<td class="container" width="600" style="font-family: \'Helvetica Neue\',Helvetica,Arial,sans-serif; box-sizing: border-box; font-size: 14px; vertical-align: top; display: block !important; max-width: 600px !important; clear: both !important; margin: 0 auto;" valign="top">\n						<div class="content" style="font-family: \'Helvetica Neue\',Helvetica,Arial,sans-serif; box-sizing: border-box; font-size: 14px; max-width: 600px; display: block; margin: 0 auto; padding: 20px;">\n								<table class="main" width="100%" cellpadding="0" cellspacing="0" itemprop="action" itemscope itemtype="http://schema.org/ConfirmAction" style="font-family: \'Helvetica Neue\',Helvetica,Arial,sans-serif; box-sizing: border-box; font-size: 14px; border-radius: 3px; background-color: #fff; margin: 0; border: 1px solid #e9e9e9;" bgcolor="#fff">\n									<tr style="font-family: \'Helvetica Neue\',Helvetica,Arial,sans-serif; box-sizing: border-box; font-size: 14px; margin: 0;">\n									<td class="content-wrap" style="font-family: \'Helvetica Neue\',Helvetica,Arial,sans-serif; box-sizing: border-box; font-size: 14px; vertical-align: top; margin: 0; padding: 20px;" valign="top">\n														\n											<meta itemprop="name" content="See Question" style="font-family: \'Helvetica Neue\',Helvetica,Arial,sans-serif; box-sizing: border-box; font-size: 14px; margin: 0;" />\n														<table width="100%" cellpadding="0" cellspacing="0" style="font-family: \'Helvetica Neue\',Helvetica,Arial,sans-serif; box-sizing: border-box; font-size: 14px; margin: 0;">\n															<tr style="font-family: \'Helvetica Neue\',Helvetica,Arial,sans-serif; box-sizing: border-box; font-size: 14px; margin: 0;">\n															<td class="content-block" style="font-family: \'Helvetica Neue\',Helvetica,Arial,sans-serif; box-sizing: border-box; font-size: 14px; vertical-align: top; margin: 0; padding: 0 0 20px;" valign="top">\n																	 Please see your question by clicking the link below.\n																</td>\n																</tr>\n																<tr style="font-family: \'Helvetica Neue\',Helvetica,Arial,sans-serif; box-sizing: border-box; font-size: 14px; margin: 0;">\n																<td class="content-block" style="font-family: \'Helvetica Neue\',Helvetica,Arial,sans-serif; box-sizing: border-box; font-size: 14px; vertical-align: top; margin: 0; padding: 0 0 20px;" valign="top">\n																				You will get notification when some activity happens on your question\n																		</td>\n																</tr>\n																<tr style="font-family: \'Helvetica Neue\',Helvetica,Arial,sans-serif; box-sizing: border-box; font-size: 14px; margin: 0;"><td class="content-block" itemprop="handler" itemscope itemtype="http://schema.org/HttpActionHandler" style="font-family: \'Helvetica Neue\',Helvetica,Arial,sans-serif; box-sizing: border-box; font-size: 14px; vertical-align: top; margin: 0; padding: 0 0 20px;" valign="top">\n																				<a href="'+d+'" class="btn-primary" itemprop="url" style="font-family: \'Helvetica Neue\',Helvetica,Arial,sans-serif; box-sizing: border-box; font-size: 14px; color: #FFF; text-decoration: none; line-height: 2em; font-weight: bold; text-align: center; cursor: pointer; display: inline-block; border-radius: 5px; text-transform: capitalize; background-color: #348eda; margin: 0; border-color: #348eda; border-style: solid; border-width: 10px 20px;">Open Question</a>\n																		</td>\n																</tr><tr style="font-family: \'Helvetica Neue\',Helvetica,Arial,sans-serif; box-sizing: border-box; font-size: 14px; margin: 0;"><td class="content-block" style="font-family: \'Helvetica Neue\',Helvetica,Arial,sans-serif; box-sizing: border-box; font-size: 14px; vertical-align: top; margin: 0; padding: 0 0 20px;" valign="top">\n																				&mdash; Integrated Learning Center\n																		</td>\n																</tr></table></td>\n										</tr></table><div class="footer" style="font-family: \'Helvetica Neue\',Helvetica,Arial,sans-serif; box-sizing: border-box; font-size: 14px; width: 100%; clear: both; color: #999; margin: 0; padding: 20px;">\n										<table width="100%" style="font-family: \'Helvetica Neue\',Helvetica,Arial,sans-serif; box-sizing: border-box; font-size: 14px; margin: 0;"><tr style="font-family: \'Helvetica Neue\',Helvetica,Arial,sans-serif; box-sizing: border-box; font-size: 14px; margin: 0;"><td class="aligncenter content-block" style="font-family: \'Helvetica Neue\',Helvetica,Arial,sans-serif; box-sizing: border-box; font-size: 12px; vertical-align: top; color: #999; text-align: center; margin: 0; padding: 0 0 20px;" align="center" valign="top">Follow <a href="http://twitter.com/askilc_center" style="font-family: \'Helvetica Neue\',Helvetica,Arial,sans-serif; box-sizing: border-box; font-size: 12px; color: #999; text-decoration: underline; margin: 0;">@askilc_center</a> on Twitter.</td>\n												</tr></table></div></div>\n				</td>\n				<td style="font-family: \'Helvetica Neue\',Helvetica,Arial,sans-serif; box-sizing: border-box; font-size: 14px; vertical-align: top; margin: 0;" valign="top"></td>\n		</tr></table></body>\n</html>',f={text:e,html:!0,to:a,subject:b};return c({method:"POST",url:"/api/sendEmail",data:f})}}}]);